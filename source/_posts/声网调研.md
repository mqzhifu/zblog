---
title: 声网调研
date: 2022-08-31 15:55:34
categories: ["技术杂谈"]
tags: [声网,TCP,UDP,音频,视频]
---
初衷
----
1. 稳定的TCP连接，数据流传输
2. 可传输音频流，包括：客户端收流的优化(回声、降噪等处理),音频流的压缩与备份
3. 可传输视频流，包括：视频流的压缩与备份、清晰度等等
4. 兼容多端

产品分类
-----
它的产品类型其实还不少：
1. 语音通话
2. 视频通话
3. 直播(互动、极速)
3. 消息推送
4. 互动白板
5. 灵动课堂等

比较意外的就是：
1. 它还定义化的产品，对教育做出了针对性的分类产品，像：白板+课堂
2. 另外，也有对云端的操控，像：云端录制，云端推流到CDN

产品分析
-----

其主要核心：
1. TCP/UDP 流控  => 稳定/速度快
2. 音视频流 控制 => 优化较好
3. 全球可用 => 节点众多

>音视频流不仅仅是对流的处理，还有对不同厂商的设备进行数据收集与播放，像：降噪、回声处理、美颜等

其它核心：支持多端且SDK齐全、文档齐全、售后服务
1. PC/H5
3. 安卓/IOS
4. mac/windows
5. unity/react native/fluter/electron

>这里比较意外的就是：除OS，它居然还支持一些3方软件，像：unity flutter 等


速度与延迟
---
我翻了它的3个主要产品：互动直播 极速直播 视频通话
视频通话：400 ms ～ 800 ms
互动直播：400 ms ～ 800 ms(主播~观众端)
极速直播：1500 ms ～ 2000 ms（主播~观众端）

>基本上能维持在1秒以下，毕竟是视频流的同步，感觉可以了。那，日常开发基本上够用，当然如果用游戏的帧同步来衡量，确实有点慢，哈哈


视频分辨率
----
最高支持2K+

收费
----
按照使用时长+分辨率+人数

不过，测试账号每月有免费的：10000分钟

账号
----
>https://console.agora.io/project/

开发如果想用它的SDK功能，得先去官网注册个账号
1. 注册账号
2. 项目管理 => 创建项目 => 项目配置
3. 这里有
    1. AppId
    2. appCertificate



SDK-类型说明
----
rtc:Real-Time Communication
>操控各种流的主要SDK，像：音频、视频这些均得使用

rtm:Real-Time Message
>推送消息的时候使用，没RTC广泛，有那么点辅助RTC的意思


云端录制屏幕
---
开启：控制台操作下即可

1. 单用户录制
2. 多用户合录
3. 音频与视频分开录制
4. 对多个音视频文件进行合并

后端restful请求
-----
有些业务，只能后端来请求，后端处理好了，再同步给前端，所以:请求声明restful接口，得配置获取key
https://console.agora.io/project/

1. 项目管理 => 右上角 => 头像 => restfulAPI
2. 添加密钥
3. 拿到HttpKey HttpSecret

用密钥生成头信息里的 auth base64码

配置回调
----
正常你用它的SDK都还好，但是像云端录制屏幕，或者：遇到一些问题，找日志的时候，得需要声网给你回调事件。

这个也是在控制台里，提交工单，让客服给你打开就行，不过要注意下，它的回调好像不同业务线不一样，都得提交
1. RTC 的回调
2. 云端的回调

具体的回调事件，对着文档就行

token鉴权
-----
正常的SDK使用，肯定得用token做验证的，这个token 声网有个UI界面可申请，但是它是建议你在后端创建token的

rtc rtm的TOKEN还不太同，得分开申请。

具体token(除了APPID 外)算法:可以去网方下载

总结
----
声网真的是太强了，不仅仅是它的TCP技术、音视频技术稳定，对多端的支持以及全球都有服务器来看，中小公司真心不推荐自建流控体系了。
如果业务定制化太高，也建议：自建一套，承接些小业务，或者自建一部分+声网的技术，混合使用。

另外，看它的API文档，上面很多功能也能反推其产品力，真的是经过了各种实践总结出来的，不管是技术上还是产品上，都挺强的。

这里随便几条技术难点：
1. 对音频/视频 收流的优化，各种格式的处理
3. 录屏
2. tcp传输的稳定性
3. 多端SDK支持
4. 售后服务/支持
5. 主流定制化的需求，像：教育、直播等等




